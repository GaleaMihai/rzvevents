<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Produs — RZVevents</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Wet+Paint&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{ --bg1:#0b0f1a; --bg2:#0f172a; --ink:#e7eefb; --muted:#9aa6c5; --btn:#d4af37; --btnHover:#c39a2f; --ring:rgba(255,255,255,.12); --card:rgba(255,255,255,.05); --maxw:1100px; }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:linear-gradient(180deg,var(--bg1) 0%,var(--bg2) 100%);line-height:1.6;}

    /* HEADER + NAV (hamburger) */
    .site-header{
      position:sticky; top:0; z-index:50; backdrop-filter:blur(8px);
      background:linear-gradient(180deg,rgba(11,15,26,.9),rgba(15,23,42,.7));
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .site-header__inner{
      max-width:var(--maxw); margin:0 auto; padding:10px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{ font-family:"Rubik Wet Paint", cursive; color:#ecf2ff; text-decoration:none; font-size:26px; }
    .nav{ display:flex; gap:16px; }
    .nav a{ color:#e7eefb; text-decoration:none; font-weight:700; padding:8px 10px; border-radius:10px; }
    .nav a:hover{ background:rgba(255,255,255,.06); }

    .nav-toggle{
      display:none; background:transparent; border:1px solid var(--ring);
      color:#e7eefb; padding:8px 10px; border-radius:10px; cursor:pointer;
      align-items:center; gap:8px;
    }
    .nav-toggle .bars{ width:18px; height:2px; background:#e7eefb; position:relative; display:block; }
    .nav-toggle .bars::before, .nav-toggle .bars::after{
      content:""; position:absolute; left:0; right:0; height:2px; background:#e7eefb;
    }
    .nav-toggle .bars::before{ top:-6px } .nav-toggle .bars::after{ top:6px }

    @media (max-width:820px){
      .nav{ display:none; position:absolute; top:100%; left:0; right:0;
            background:linear-gradient(180deg,rgba(11,15,26,.98),rgba(15,23,42,.95));
            border-bottom:1px solid rgba(255,255,255,.06);
            padding:10px 16px; flex-direction:column; gap:8px; }
      .nav.open{ display:flex; }
      .nav a{ padding:10px 12px }
      .nav-toggle{ display:inline-flex; }
    }

    /* PAGE */
    .wrap{max-width:var(--maxw);margin:0 auto;padding:24px 16px}
    h1{font-family:"Rubik Wet Paint", cursive;font-size:clamp(36px,7vw,72px);margin:0 0 8px;color:#ecf2ff;text-shadow:0 3px 0 #111827,0 6px 18px #000,0 0 36px #60a5fa55,0 0 80px #3b82f655;}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
    .card{background:var(--card);border:1px solid var(--ring);border-radius:18px;padding:16px}
    .price{font-weight:800;font-size:20px}
    .btn{display:inline-block;text-decoration:none;font-weight:800;color:#111;background:var(--btn);border:1px solid rgba(0,0,0,.08);border-radius:14px;padding:12px 18px;transition:.2s}
    .btn:hover{background:var(--btnHover);transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.45)}
    .back{display:inline-block;margin-top:16px;color:var(--muted);text-decoration:none}
    .back:hover{color:var(--ink);text-decoration:underline}

    /* HERO (contain pe alb) */
    .hero-wrap{position:relative}
    .heroimg{
      aspect-ratio:4/3;
      border-radius:16px;border:1px solid var(--ring);
      background:#fff center/contain no-repeat;
      cursor:pointer;
    }
    .nav-btn{
      position:absolute; top:50%; transform:translateY(-50%);
      width:42px; height:42px; border-radius:999px; border:1px solid var(--ring);
      background:rgba(0,0,0,.35); color:#fff; font-weight:800;
      display:grid; place-items:center; cursor:pointer; user-select:none;
    }
    .nav-btn:hover{background:rgba(0,0,0,.5)}
    .nav-prev{left:10px}
    .nav-next{right:10px}

    /* table */
    .kv{display:grid;grid-template-columns:160px 1fr;gap:6px;margin:6px 0;color:var(--muted)}
    .kv b{color:#fff}
    .tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .tag{padding:6px 10px;border:1px solid var(--ring);border-radius:999px;background:rgba(255,255,255,.04);font-weight:700}

    /* compatibile */
    .rel{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
    .rel a{color:inherit;text-decoration:none}
    .rel .tile{border:1px solid var(--ring);background:var(--card);border-radius:14px;overflow:hidden}
    .tile .img{
      aspect-ratio:4/3;
      background:#fff center/contain no-repeat;
    }
    .tile .pad{padding:10px}

    /* Lightbox */
    .lightbox{
      position:fixed; inset:0; background:rgba(0,0,0,.9);
      display:none; align-items:center; justify-content:center; z-index:9999;
    }
    .lightbox.open{display:flex}
    .lb-img{
      max-width:92vw; max-height:92vh; border-radius:16px; border:1px solid #222;
      background:#000 center/contain no-repeat; width:92vw; height:92vh;
    }
    .lb-btn{
      position:fixed; top:50%; transform:translateY(-50%);
      width:52px; height:52px; border-radius:999px; border:1px solid #333;
      background:rgba(255,255,255,.08); color:#fff; font-weight:800;
      display:grid; place-items:center; cursor:pointer; user-select:none;
    }
    .lb-prev{left:18px}
    .lb-next{right:18px}
    .lb-close{
      position:fixed; top:18px; right:18px;
      width:44px; height:44px; border-radius:999px; border:1px solid #333;
      background:rgba(255,255,255,.1); color:#fff; display:grid; place-items:center; cursor:pointer;
      font-weight:900;
    }

    /* FOOTER + WHATSAPP FAB */
    footer{ border-top:1px solid rgba(255,255,255,.06); padding:18px 16px; text-align:center; color:var(--muted); }
    .wa-fab{
      position:fixed; right:18px; bottom:18px; z-index:60;
      background:var(--btn); color:#111; border:1px solid rgba(0,0,0,.08);
      border-radius:999px; padding:12px 18px; font-weight:800; text-decoration:none;
      box-shadow:0 10px 24px rgba(0,0,0,.35);
    }
    .wa-fab:hover{ background:var(--btnHover); transform:translateY(-1px); }
  </style>
</head>
<body>

  <!-- HEADER cu hamburger -->
  <header class="site-header">
    <div class="site-header__inner">
      <a href="index.html" class="brand">RZVevents</a>

      <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav" aria-label="Deschide meniul">
        <span class="bars" aria-hidden="true"></span> Meniu
      </button>

      <nav id="site-nav" class="nav" role="navigation">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="products.html">Products</a>
        <a href="evenimente.html">Evenimente</a>
        <a href="contact.html">Contact</a>
      </nav>
    </div>
  </header>

  <div class="wrap">
    <a class="back" href="products.html">← Înapoi la produse</a>
    <h1 id="p-name">Produs</h1>
    <p class="muted" id="p-category"></p>

    <div class="grid">
      <!-- Galerie 1× cu săgeți -->
      <div class="card hero-wrap">
        <div id="heroimg" class="heroimg" title="Click pentru a mări"></div>
        <button class="nav-btn nav-prev" aria-label="Prev">&#10094;</button>
        <button class="nav-btn nav-next" aria-label="Next">&#10095;</button>
      </div>

      <!-- Detalii -->
      <div class="card">
        <div class="price" id="p-price"></div>
        <div class="kv"><span>Stoc total</span> <b id="p-stock"></b></div>
        <div class="kv"><span>Dimensiuni</span> <b id="p-dim"></b></div>
        <div class="kv"><span>Material</span> <b id="p-mat"></b></div>
        <div class="kv"><span>Culoare</span> <b id="p-color"></b></div>
        <div class="tags" id="p-tags"></div>
        <div style="margin-top:12px">
          <a id="wa" class="btn" target="_blank" rel="noopener">Cere ofertă pe WhatsApp</a>
        </div>
      </div>

      <!-- Descriere -->
      <div class="card" style="grid-column:1/-1">
        <h3 style="margin:0 0 8px">Descriere</h3>
        <p class="muted" id="p-desc"></p>
      </div>
    </div>

    <!-- Produse compatibile -->
    <div class="card" style="margin-top:16px">
      <h3 style="margin:0 0 8px">Produse compatibile</h3>
      <div id="related" class="rel"></div>
    </div>
  </div>

  <!-- Lightbox full-screen -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div id="lbimg" class="lb-img"></div>
    <button class="lb-btn lb-prev" aria-label="Prev">&#10094;</button>
    <button class="lb-btn lb-next" aria-label="Next">&#10095;</button>
    <button class="lb-close" aria-label="Close">&times;</button>
  </div>

  <footer>
    © <span id="year"></span> RZVevents · Cluj-Napoca · <a href="mailto:razvan@rzvevents.ro" style="color:inherit">razvan@rzvevents.ro</a>
  </footer>

  <!-- WhatsApp FAB (text) -->
  <a id="waFab" class="wa-fab" target="_blank" rel="noopener" aria-label="Scrie pe WhatsApp">WhatsApp</a>

  <script>
    const PHONE_E164 = '40712345678'; // pune numărul tău (fără +)
    const params = new URLSearchParams(location.search);
    const PID = params.get('id');

    // HEADER hamburger
    const toggleBtn = document.addEventListener('DOMContentLoaded', ()=>{
      const btn = document.querySelector('.nav-toggle');
      const nav = document.getElementById('site-nav');
      btn.addEventListener('click', ()=>{
        const open = nav.classList.toggle('open');
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
        btn.setAttribute('aria-label', open ? 'Închide meniul' : 'Deschide meniul');
      });
      nav.querySelectorAll('a').forEach(a=>a.addEventListener('click', ()=>{
        if(nav.classList.contains('open')){ nav.classList.remove('open'); btn.setAttribute('aria-expanded','false'); btn.setAttribute('aria-label','Deschide meniul'); }
      }));
    });

    // elemente
    const el = {
      name: document.getElementById('p-name'),
      category: document.getElementById('p-category'),
      price: document.getElementById('p-price'),
      stock: document.getElementById('p-stock'),
      dim: document.getElementById('p-dim'),
      mat: document.getElementById('p-mat'),
      color: document.getElementById('p-color'),
      tags: document.getElementById('p-tags'),
      desc: document.getElementById('p-desc'),
      wa: document.getElementById('wa'),
      heroimg: document.getElementById('heroimg'),
      related: document.getElementById('related'),
      wrap: document.querySelector('.wrap'),
      navPrev: document.querySelector('.nav-prev'),
      navNext: document.querySelector('.nav-next'),
      lb: document.getElementById('lightbox'),
      lbImg: document.getElementById('lbimg'),
      lbPrev: document.querySelector('.lb-prev'),
      lbNext: document.querySelector('.lb-next'),
      lbClose: document.querySelector('.lb-close'),
      waFab: document.getElementById('waFab')
    };

    async function loadProducts() {
      const r = await fetch('data/products.json');
      if (!r.ok) throw new Error('Nu pot încărca data/products.json (status ' + r.status + ')');
      return r.json();
    }

    function waLink(name) {
      const msg = `Bună! Aș dori o ofertă pentru: ${name}. Data: ____ . Locația: ____ .`;
      return `https://wa.me/${PHONE_E164}?text=${encodeURIComponent(msg)}`;
    }

    function fmtDim(d) {
      if (!d) return '—';
      const vals = [];
      if (d.L ?? d.l) vals.push((d.L ?? d.l));
      if ((d.l && d.L===undefined) && !vals.includes(d.l)) vals.push(d.l);
      if (d.H ?? d.h) vals.push((d.H ?? d.h));
      return vals.length ? `${vals.join(' × ')} cm` : '—';
    }

    function showError(msg) {
      el.wrap.innerHTML = `<p style="color:#fca5a5;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);padding:12px;border-radius:12px">
        ${msg} <br>Verifică: serverul local, calea <code>data/products.json</code> și URL-ul <code>?id=</code>.
      </p>`;
    }

    (async () => {
      // footer year
      document.getElementById('year').textContent = new Date().getFullYear();

      try {
        const list = await loadProducts();
        const item = list.find(x => String(x.id) === String(PID)) || list[0];
        if (!item) { showError('Nu am găsit produsul cerut.'); return; }

        // Title & category
        document.title = `${item.name} — RZVevents`;
        el.name.textContent = item.name;
        el.category.textContent = (item.category_label || item.category || '');

        // Price + stock + attrs
        el.price.textContent = `${item.price_per_day} RON / zi`;
        el.stock.textContent = item.total_stock ?? '—';
        el.dim.textContent = fmtDim(item.dimensions);
        el.mat.textContent = item.material || '—';
        el.color.textContent = item.color || '—';
        el.desc.textContent = item.description || '—';

        // WhatsApp (buton din card) + FAB contextual
        const link = waLink(item.name);
        el.wa.href = link;
        if (el.waFab) el.waFab.href = link;

        // TAGS
        (item.tags || []).forEach(t => {
          const s = document.createElement('span');
          s.className = 'tag';
          s.textContent = t;
          el.tags.appendChild(s);
        });

        // IMAGES: carusel 1× + lightbox (contain pe alb)
        const imgs = (item.images && item.images.length ? item.images : (item.image ? [item.image] : []));
        let idx = 0;
        const setHero = (i) => {
          if (!imgs.length) { el.heroimg.style.backgroundImage = ''; return; }
          idx = (i + imgs.length) % imgs.length;
          el.heroimg.style.backgroundImage = `url('${imgs[idx]}')`;
          el.lbImg.style.backgroundImage = `url('${imgs[idx]}')`;
        };
        setHero(0);

        function next(){ setHero(idx+1); }
        function prev(){ setHero(idx-1); }

        el.navNext.addEventListener('click', next);
        el.navPrev.addEventListener('click', prev);

        // Lightbox open/close + nav
        function openLB(){ if(!imgs.length) return; el.lb.classList.add('open'); el.lb.setAttribute('aria-hidden','false'); }
        function closeLB(){ el.lb.classList.remove('open'); el.lb.setAttribute('aria-hidden','true'); }
        el.heroimg.addEventListener('click', openLB);
        el.lbClose.addEventListener('click', closeLB);
        el.lbNext.addEventListener('click', next);
        el.lbPrev.addEventListener('click', prev);
        el.lb.addEventListener('click', (e)=>{ if(e.target===el.lb) closeLB(); });
        window.addEventListener('keydown', (e)=>{
          if(!el.lb.classList.contains('open')) return;
          if(e.key==='Escape') closeLB();
          if(e.key==='ArrowRight') next();
          if(e.key==='ArrowLeft') prev();
        });

        // „Produse compatibile”
        const rel = list.filter(x => x.id!==item.id)
                        .filter(x => x.category===item.category
                          || (item.category==='mese' && x.category==='scaune')
                          || (item.category==='scaune' && x.category==='mese'))
                        .slice(0,4);
        el.related.innerHTML = rel.map(r => `
          <a class="tile" href="product.html?id=${encodeURIComponent(r.id)}">
            <div class="img" style="background-image:url('${(r.images && r.images[0]) || r.image || ''}')"></div>
            <div class="pad">
              <div style="font-weight:800">${r.name}</div>
              <div class="muted">${r.price_per_day} RON/zi</div>
            </div>
          </a>
        `).join('');

      } catch (e) {
        console.error(e);
        showError('Eroare la încărcarea datelor produsului: ' + e.message);
      }
    })();
  </script>
</body>
</html>
